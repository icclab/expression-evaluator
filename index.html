<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>expression-evaluator micro service by icclab</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>expression-evaluator micro service</h1>
        <p>a micro-service to enable on the fly expression evaluation</p>

        <p class="view"><a href="https://github.com/icclab/expression-evaluator">View the Project on GitHub <small>icclab/expression-evaluator</small></a></p>


        <ul>
          <li><a href="https://github.com/icclab/expression-evaluator/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/icclab/expression-evaluator/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/icclab/expression-evaluator">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="expression-evaluator" class="anchor" href="#expression-evaluator" aria-hidden="true"><span class="octicon octicon-link"></span></a>expression-evaluator</h1>

<p>A micro-service to enable on the fly expression evaluation.</p>

<h1>
<a id="motivation" class="anchor" href="#motivation" aria-hidden="true"><span class="octicon octicon-link"></span></a>motivation</h1>

<p>ETSI has specified the guidelines for virtual network function (VNF) descriptors and network service (NS) descriptors. These descriptors can be extended to contain assurance expressions and monitoring paramaters for constitutent VNFs of the NS. For NS orchestration, especially if the orchestrator design is influenced by micro-services design pattern, a small service that quickly evaluates these ETSI compliant VNF assurance expressions can be handy.</p>

<h1>
<a id="supported-expressions" class="anchor" href="#supported-expressions" aria-hidden="true"><span class="octicon octicon-link"></span></a>supported expressions</h1>

<p>This micro-service provides a REST API for on-the-fly expression evaluation, the expression must be a well formed functional composition. You can think of it as synonimous to a prefix expression. Parameters and constants are allowed, and the parameters values to be used in the expression must be supplied with the API call for evaluation.</p>

<p>Any well formed composed function expression is supported (to any depth)- </p>

<p><code>fn-x(p1, p2, fn-y(q1, q2, fn-z(r1, r2, r3)))</code></p>

<p>The parameter list must be passed in the order they appear in the expression as a JSON array.</p>

<h2>
<a id="example-expressions" class="anchor" href="#example-expressions" aria-hidden="true"><span class="octicon octicon-link"></span></a>example expressions</h2>

<h3>
<a id="vnf-availability" class="anchor" href="#vnf-availability" aria-hidden="true"><span class="octicon octicon-link"></span></a>vnf availability</h3>

<p>GT(min(vnfs[1].availability, vnfs[2].availability))</p>

<h3>
<a id="ns-ram-consumption" class="anchor" href="#ns-ram-consumption" aria-hidden="true"><span class="octicon octicon-link"></span></a>ns ram consumption</h3>

<p>LT(add(vnfs[1].memory-consumption, vnfs[2].memory-consumption, 100))</p>

<h1>
<a id="current-functions-support" class="anchor" href="#current-functions-support" aria-hidden="true"><span class="octicon octicon-link"></span></a>current functions support</h1>

<ol>
<li>
<code>add()</code> - sum of parameters</li>
<li>
<code>min()</code> - minimum value selection from the argument list</li>
<li>
<code>max()</code> - maximum value selection from the argument list</li>
<li>
<code>avg()</code> - average of the parameters</li>
<li>
<code>lt()</code> - true if the argument is less than a threshold - threshold value is provided separately</li>
<li>
<code>gt()</code> - true if the argument is greater than a threshold - threshold value is provided sepaately</li>
</ol>

<h1>
<a id="installation-requirements" class="anchor" href="#installation-requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>installation requirements</h1>

<ul>
<li>Java runtime environemt (7.0 or higher)</li>
<li>maven 3.0 or higher</li>
</ul>

<h1>
<a id="one-step-installation-steps-ubuntu-or-debian-system" class="anchor" href="#one-step-installation-steps-ubuntu-or-debian-system" aria-hidden="true"><span class="octicon octicon-link"></span></a>one-step installation steps (ubuntu or debian system)</h1>

<ul>
<li>download the setup script - <a href="https://raw.githubusercontent.com/piyush82/expression-evaluator/master/setup.sh">https://raw.githubusercontent.com/piyush82/expression-evaluator/master/setup.sh</a>
</li>
<li>make the script executable - <code>chmod +x setup.sh</code>
</li>
<li>execute the script - <code>./setup.sh</code>
</li>
<li>follow the prompts and you are done. You will be prompted to provide certain inputs during the script execution. See configuration parameters section below.</li>
</ul>

<h1>
<a id="configuration-parameters" class="anchor" href="#configuration-parameters" aria-hidden="true"><span class="octicon octicon-link"></span></a>configuration parameters</h1>

<ul>
<li>log file location - when prompted do provide the full path of the log file in the log4j configuration file. The field to be modified is <code>log4j.appender.file.File</code>.</li>
<li>database file location - when prompted, provide the full path of the sqlite database file, the field in expressionsolver.conf file is <code>dbfile</code>.</li>
<li>
<code>showexceptions</code> - if set to true, the exceptions stack trace will be dumped otherwise exceptions will be supressed.</li>
<li>
<code>port</code> - the port number where the service will be running.</li>
<li>
<code>dbengine</code> - currently only sqlite is supported, in future other backends will be supported.</li>
</ul>

<h1>
<a id="currently-supported-api" class="anchor" href="#currently-supported-api" aria-hidden="true"><span class="octicon octicon-link"></span></a>currently supported API</h1>

<p>The expression evaluator currently only supports stateless evaluations, but this will change in future where expressions can be registered with the service, and later invoked with full or partial parameter list.</p>

<p>In any API call, <code>Content-Type</code> header field must be provided. Currently supported type is <code>application/json</code>.</p>

<h2>
<a id="ip-addressportexp-evalotfly-post---example" class="anchor" href="#ip-addressportexp-evalotfly-post---example" aria-hidden="true"><span class="octicon octicon-link"></span></a>ip-address:port/exp-eval/otfly/ [POST] - example</h2>

<p><code>curl -X POST http://localhost:8000/exp-eval/otfly/ --header "Content-Type:application/json" -d '{"exp":"GT(min(vnfd[0].availability, vnfd[1].availability))", "values":["200.1", "109.58"], "threshold":"95"}'</code></p>

<p>The parameter values are provided as a JSON array. Keep in mind even numbers are passed as string in the array.</p>

<p>Sample response if all goes as planned (HTTP Status Code: 200)- </p>

<pre>
{
    "result": "true",
    "info": "t-nova expression evaluation service",
    "status": "ok"
}
</pre>

<p>If expression evaluation fails due to malformed expression or missing parameter value, the response will look like (with HTTP Status Code: 400) -</p>

<pre>
{
  "msg": "malformed request parameters, check your expression or parameter list for correctness.",
  "info": "t-nova expression evaluation service",
  "status": "execution failed"
}
</pre>

<h2>
<a id="ip-addressportkpi-get" class="anchor" href="#ip-addressportkpi-get" aria-hidden="true"><span class="octicon octicon-link"></span></a>ip-address:port/kpi [GET]</h2>

<p>This API call allows one to get some of the system counters. Currently, this call also resets the counters. But this will change very soon. The response body exaple is below.</p>

<pre>
{
 "msg": "kpi parameters data",
 "data-since": "2015-11-05 17:38:18 GMT+01:00",
 "src": "t-nova expression evaluation service",
 "api-calls-failed": 0,
 "expressions-under-evaluation": 0,
 "api-calls-total": 5,
 "api-calls-success": 5,
 "expressions-evaluated": 0
}
</pre>

<h1>
<a id="need-more-info-or-want-to-contribute" class="anchor" href="#need-more-info-or-want-to-contribute" aria-hidden="true"><span class="octicon octicon-link"></span></a>need more info or want to contribute</h1>

<p>Please contact me at <code>piyush DOT harsh AT zhaw DOT ch</code>.</p>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p>this software is licensed under the
<a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License version 2.0</a>.
See the file LICENSE.</p>

<h1>
<a id="made-by" class="anchor" href="#made-by" aria-hidden="true"><span class="octicon octicon-link"></span></a>Made by</h1>

<div align="center">
<a href="http://blog.zhaw.ch/icclab">
<img src="https://raw.githubusercontent.com/icclab/hurtle/master/docs/figs/icclab_logo.png" title="hurtle" width="400px">
</a>
</div>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/icclab">icclab</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
